@model OnlineShopMASK.Core.Models.Product
@{
    ViewBag.Title = Model.Name;
    var comments = (IEnumerable<OnlineShopMASK.Core.Models.ProductRating>)ViewBag.Comments;
    var ratingSum = ViewBag.RatingSum;
    var ratingCount = ViewBag.RatingCount;

    decimal rating = 0;
    if (ratingCount > 0)
    {
        rating = (ratingSum / ratingCount);
    }
    var totalRating = decimal.Parse(rating.ToString());
}

<div class="card mb-3 container-fluid border-0" style="max-width:inherit;">

    <div class="row no-gutters">
        <div class="col-md-8">
            <img src="~/Content/ProductImages/@Model.Image" class="card-img" alt="today special image" height="420px;">
        </div>
        <div class="col-md-4">
            <div class="card-body">
                <h4 class="card-title"> @Html.DisplayFor(model => model.Name)</h4>
                <h5> @Html.DisplayNameFor(model => model.Description)</h5>
                <p class="card-text">
                    @Html.DisplayFor(model => model.Description)
                </p>
                <b>Price:  @Html.DisplayFor(model => model.Price)</b>
                <hr />
                <a href="@Url.Action("AddToBasket", "Basket", new { Id=Model.Id})" class="btn btn-outline-primary float-right">Add to Basket</a>
                <a href="#" class="btn btn-outline-danger float-left"> Add to WishList</a>

            </div>
        </div>
    </div>
</div>


@foreach (var c in comments)
{
    <div class="row">
        <div class="col-md-3">
            <i>@c.CreatedAt</i>
            <br />
            @for (var i = 1; i <= c.Rating; i++)
            {
                <span class="starGlowN">hellllo</span>
            }
            @for (var i = (c.Rating + 1); i <= 5; i++)
            {
                <span class="starFadeN"></span>
            }
        </div>
        <div class="col-md-9">
            @Html.Raw(c.Comments.Replace("\n", "<br />"))


        </div>
    </div>
}

@Html.Partial("_CommentBox")


<div class="mb-2">
    <a href="@Url.Action("Index", "ProductView")" class="btn btn-outline-dark"> Back to List</a>
</div>
<div class="col-md-12 clearfix"></div>

<script>
    function SCRate() {
        for (var i = 1; i <= @totalRating; i++) {
            $("#sRate" + i).attr('class', 'starGlowN');
        }
    }
    $(function(){
        SCRate();
    });
</script>